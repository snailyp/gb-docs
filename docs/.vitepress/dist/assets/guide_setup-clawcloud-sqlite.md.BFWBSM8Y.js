import{_ as t,c as l,o as i,ae as e}from"./chunks/framework.Dh1jimFm.js";const s="/assets/image-18.DCTHpYyP.png",o="/assets/image-19.rTuItbkU.png",p="/assets/image-20.Dglk4JG6.png",n="/assets/image-21.CkO9IrAU.png",b=JSON.parse('{"title":"从零部署 Gemini Balance 手册之clawcloud上部署sqlite版本","description":"","frontmatter":{},"headers":[],"relativePath":"guide/setup-clawcloud-sqlite.md","filePath":"guide/setup-clawcloud-sqlite.md"}'),c={name:"guide/setup-clawcloud-sqlite.md"};function r(u,a,d,h,g,m){return i(),l("div",null,a[0]||(a[0]=[e(`<h1 id="从零部署-gemini-balance-手册之clawcloud上部署sqlite版本" tabindex="-1">从零部署 Gemini Balance 手册之clawcloud上部署sqlite版本 <a class="header-anchor" href="#从零部署-gemini-balance-手册之clawcloud上部署sqlite版本" aria-label="Permalink to &quot;从零部署 Gemini Balance 手册之clawcloud上部署sqlite版本&quot;">​</a></h1><p>感谢<a href="https://t.me/ykikii" target="_blank" rel="noreferrer">热佬kiki</a>提供的clawcloud部署sqlite版本教程</p><div class="caution custom-block github-alert"><p class="custom-block-title">CAUTION</p><p></p><h4 id="内容概述" tabindex="-1">内容概述 <a class="header-anchor" href="#内容概述" aria-label="Permalink to &quot;内容概述&quot;">​</a></h4><ol><li>为零代码基础用户提供“入门级”路径。</li><li>极简配置，轻量维护。</li><li>减少后端配置，尽量前端可视化。</li></ol></div><h2 id="部署项目篇" tabindex="-1">部署项目篇 <a class="header-anchor" href="#部署项目篇" aria-label="Permalink to &quot;部署项目篇&quot;">​</a></h2><div class="note custom-block github-alert"><p class="custom-block-title">NOTE</p><p></p><h5 id="基本步骤" tabindex="-1">基本步骤 <a class="header-anchor" href="#基本步骤" aria-label="Permalink to &quot;基本步骤&quot;">​</a></h5><ol><li>注册账号</li><li>部署项目</li><li>监控面板配置</li><li>接入工具</li></ol></div><h3 id="项目部署系列之-clawcloud-run-部署" tabindex="-1">项目部署系列之 ClawCloud Run 部署 <a class="header-anchor" href="#项目部署系列之-clawcloud-run-部署" aria-label="Permalink to &quot;项目部署系列之 ClawCloud Run 部署&quot;">​</a></h3><ol><li><h4 id="注册账号" tabindex="-1">注册账号 <a class="header-anchor" href="#注册账号" aria-label="Permalink to &quot;注册账号&quot;">​</a></h4><div class="important custom-block github-alert"><p class="custom-block-title">IMPORTANT</p><p></p><p>1.免费使用前提条件。需通过 Github 账户登录，且 Github 账户注册时间超过 180 天。可在登录前自行前往github.com 个人资料界面确认。否则，可能导致一个月后本项目无法运行。</p><p>2.没有符合条件的 Github 账户怎么办？（1）更换部署方式；（2）购买，价格约 10 元左右/个。</p></div><ul><li>进入 ClawCloud Run 页面：<a href="https://run.claw.cloud" target="_blank" rel="noreferrer">https://run.claw.cloud</a>，点击“Get started for free”。</li></ul></li></ol><img src="https://raw.githubusercontent.com/slashkkk/typora/main/20250511115222136.png" alt="image-20250510012805697" style="zoom:50%;"><ul><li>点击 Github 登录</li></ul><p><img src="https://raw.githubusercontent.com/slashkkk/typora/main/20250511115231899.png" alt="image-20250510013236290"></p><ul><li>进入 Github 登录界面后，输入账户名、密码，随后点击 Sign in。</li></ul><p><img src="https://raw.githubusercontent.com/slashkkk/typora/main/20250511115243830.png" alt="image-20250510013643121"></p><ol start="2"><li><h4 id="部署项目" tabindex="-1">部署项目 <a class="header-anchor" href="#部署项目" aria-label="Permalink to &quot;部署项目&quot;">​</a></h4></li></ol><ul><li>进入主界面后，点击左上角 Region，选择服务器地址。推荐选择 Singapore。选择完成后，网页会刷新，并在服务器地址前☑️。</li></ul><p><img src="https://raw.githubusercontent.com/slashkkk/typora/main/20250511115249925.png" alt="image-20250510014049153"></p><ul><li>点击 App Launchpad。</li></ul><p><img src="https://raw.githubusercontent.com/slashkkk/typora/main/20250511115303478.png" alt="image-20250510235220258"></p><ul><li>进入页面后，点击页面右上角 Create App，进入配置页面。</li></ul><p><img src="https://raw.githubusercontent.com/slashkkk/typora/main/20250511115312163.png" alt="image-20250510014403272"></p><ul><li><p>进入配置页面后，按顺序填写信息（不熟悉项目名称的，请打开在线翻译）。</p><ul><li><p>Application Name：为方便识别管理，建议填写本项目名字<code>geminibalance</code></p></li><li><p>Image： <code>Public</code></p><ul><li>Image Name：<code>ghcr.io/snailyp/gemini-balance:latest</code></li></ul><p><img src="https://raw.githubusercontent.com/slashkkk/typora/main/20250511115317145.png" alt="image-20250510234537611"></p></li><li><p>Usage：<code>Fixed</code>；</p></li><li><p>Replicas：<code>1</code></p></li><li><p>CPU：<code>1</code></p></li><li><p>Memory：<code>512</code></p><blockquote><p>说明：1. 若登录账号只选择部署 1 个项目，则推荐上述最高免费配置。2.目前免费用户每月流量为 10g，超出部分 0.05 美元/g。可根据流量使用情况选择服务器配置。</p></blockquote><p><img src="https://raw.githubusercontent.com/slashkkk/typora/main/20250511115321005.png" alt="image-20250510020253079"></p></li><li><p>Network</p><ul><li>Container Port：<code>8000</code></li><li>Enable Internet：点选为<code>Access</code>状态</li></ul><p><img src="https://raw.githubusercontent.com/slashkkk/typora/main/20250511115325230.png" alt="image-20250510020332217"></p></li><li><p><strong>Advanced Configura</strong></p><ul><li><p>Environment Variables：点击 Add，随后粘贴以下变量。填写完成后点击 Add 完成配置。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>DATABASE_TYPE=sqlite</span></span>
<span class="line"><span>SQLITE_DATABASE=default_db</span></span>
<span class="line"><span>API_KEYS=[&quot;&quot;]</span></span>
<span class="line"><span>ALLOWED_TOKENS=[&quot;&quot;]</span></span>
<span class="line"><span>AUTH_TOKEN=TZ=Asia/Shanghai</span></span></code></pre></div><div class="important custom-block github-alert"><p class="custom-block-title">IMPORTANT</p><p></p><p><strong>变量说明</strong></p><table tabindex="0"><thead><tr><th><strong>变量名</strong></th><th>说明</th><th>格式及示例</th></tr></thead><tbody><tr><td><code>API_KEYS</code></td><td>Gemini API 密钥列表，用于负载均衡</td><td><code>[&quot;your-gemini-api-key-1&quot;,&quot;your-gemini-api-key-2&quot;]</code></td></tr><tr><td><code>ALLOWED_TOKENS</code></td><td>允许访问的 Token 列表</td><td><code>[&quot;your-access-token-1&quot;,&quot;your-access-token-2&quot;]</code></td></tr><tr><td><code>AUTH_TOKEN</code></td><td>【可选】超级管理员token，具有所有权限，不填默认使用 ALLOWED_TOKENS 的第一个</td><td><code>sk-123456</code></td></tr></tbody></table><ul><li><p>5 个&quot;MYSQL&quot;开头的变量为数据库配置，请参照部署文档有关数据库篇目获取。</p></li><li><p>TZ=Asia/Shanghai 用来控制时区方便看日志信息。</p></li><li><p>最简完整示例如下：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>API_KEYS=[&quot;your-gemini-api-key-1&quot;,&quot;your-gemini-api-key-2&quot;]</span></span>
<span class="line"><span>ALLOWED_TOKENS=[&quot;your-access-token-1&quot;,&quot;your-access-token-2&quot;]</span></span>
<span class="line"><span>DATABASE_TYPE=sqlite</span></span>
<span class="line"><span>SQLITE_DATABASE=default_db</span></span>
<span class="line"><span>TZ=Asia/Shanghai</span></span></code></pre></div><blockquote><p>注意：API_KEYS 和 ALLOWED_TOKENS 的值可以先不修改，待进入监控面板后再更正。（若按图中配置，则进入监控页面的密码为your-access-token-1）</p><p>SQLITE_DATABASE变量值必须填写，否则导致部署失败。</p></blockquote></li></ul></div></li></ul></li></ul></li></ul><p><img src="https://raw.githubusercontent.com/slashkkk/typora/main/20250511115332470.png" alt="image-20250510020415152"></p><p>​- 添加玩环境变量后，再按照下图设置storage</p><p>​ <img src="`+s+'" alt="添加存储-1"></p><p><img src="'+o+'" alt="添加存储-2"></p><ul><li><p>返回页面最上方，点击 Deploy Application。弹窗提示Are you sure you want to deploy the application?选择 Yes。</p><p><img src="https://raw.githubusercontent.com/slashkkk/typora/main/20250511120653544.png" alt="image-20250511120648573"></p></li><li><p>等待几秒后，跳转至状态界面。此时，请确认页面左上角显示 running。若显示为其他状态，请稍后片刻；仍未显示 running，请确认你配置选项是否正确。需要修改的，可点击页面右下角 Manage Network 选项修改参数，或删除该项目重新部署。</p><p><img src="https://raw.githubusercontent.com/slashkkk/typora/main/20250511120600152.png" alt="image-20250511120554449"></p></li><li><p>将页面滚动到最下方，在 Network 选项卡中，查看右侧公网地址配置情况。一般情况下，显示 pending 表明还在处理当中，需要等待 2～5 分钟，直至pending 状态变为Available。 实际情况下， 2 分钟后即使公网地址前显示pending，亦可尝试在新的浏览器标签中打开该地址。若网页能正常显示本项目登录界面，则正常使用即可。若公网地址前的pending状态超过 10 分钟，且无法打开登录界面，原因可能是服务器过载，需要更长等待时间。建议换区或换服务商重新部署。</p><p><img src="https://raw.githubusercontent.com/slashkkk/typora/main/20250511120452198.png" alt="image-20250511120429596"></p><div class="note custom-block github-alert"><p class="custom-block-title">NOTE</p><p></p><p>设置自定义域名</p><p>在cloudflare添加cname记录，如我希望域名为ggg.abc.xyz，cloudflare中这样设置，abc.xyz为托管在cloudflare域名 <img src="'+p+'" alt="alt text"> 在clawcloud这样设置，这样就可以自定义域名访问 <img src="'+n+'" alt="alt text"></p></div></li></ul><ol start="3"><li><h4 id="监控页面配置" tabindex="-1">监控页面配置 <a class="header-anchor" href="#监控页面配置" aria-label="Permalink to &quot;监控页面配置&quot;">​</a></h4><ul><li>复制项目公网访问地址后，在浏览器中打开。随后进入登录界面，输入密码即可进入。（如果没有更改配置，密码是<code>your-access-token-1</code>）</li></ul><p><img src="https://raw.githubusercontent.com/slashkkk/typora/main/20250511115409852.png" alt="image-20250510023055219"></p><ul><li><p>修改API 密钥和访问令牌。</p></li><li><p>完成上述配置后到页面最下方点击“保存配置”，并确认提示“配置保存成功”。</p></li></ul><p><img src="https://raw.githubusercontent.com/slashkkk/typora/main/20250511115417087.png" alt="image-20250510224438602"></p><div class="note custom-block github-alert"><p class="custom-block-title">NOTE</p><p></p><p>完成以上步骤后，就可以在工具中调用本项目。</p><p>更高阶的配置，请参阅项目文档。</p></div></li><li><h4 id="接入工具" tabindex="-1">接入工具 <a class="header-anchor" href="#接入工具" aria-label="Permalink to &quot;接入工具&quot;">​</a></h4><p>以 cherry studio 为例</p><ul><li><p>添加提供商。</p><ul><li>提供商名称：任意填写</li><li><img src="https://raw.githubusercontent.com/slashkkk/typora/main/20250511115425468.png" alt="image-20250511100831232"></li></ul></li><li><p>配置</p><ul><li>API 密钥：填写监控面板“API 密钥”选项卡中的“允许的令牌列表”。</li><li>API 地址：填写 ClawCloud 中的公网访问地址。注意结尾不要出现“/”。<img src="https://raw.githubusercontent.com/slashkkk/typora/main/20250511115434846.png" alt="image-20250510230659798"></li></ul></li><li><p>添加模型</p><p>点击“管理”，添加模型。</p><p><img src="https://raw.githubusercontent.com/slashkkk/typora/main/20250511115449358.png" alt="image-20250510230909905"></p><p>至此，部署完成。</p></li></ul></li></ol><hr><h2 id="常见问题补充" tabindex="-1">常见问题补充 <a class="header-anchor" href="#常见问题补充" aria-label="Permalink to &quot;常见问题补充&quot;">​</a></h2><ol><li>关于提示密码错误的问题。如果配置数据库之后，无法通过 AUTH_TOKEN 登录界面（提示&quot;密码错误&quot;），可能是因为数据库的问题。排查步骤如下：</li></ol><ul><li>如果是新部署项目、但使用了以前的数据库，则可尝试通过以前配置过的密码登录。原因是实际的AUTH_TOKEN在项目初始化的时候，就已经保存到数据库中，后面修改环境变量，不会生效，所以建议在项目初始化之前就要设置好AUTH_TOKEN。也可以把这个过程理解为数据库的迁移，所以利用老数据库部署新项目时，实际上只需要配置 5 个 MYSQL 变量即可。 <ul><li>如果要使用新的登录密码，请重新关联新的数据库。</li></ul></li><li>如果是新部署项目、并且使用了新的数据库，请再次核对配置变量信息及数据库配置信息。</li></ul>',30)]))}const q=t(c,[["render",r]]);export{b as __pageData,q as default};
